Sub invoicegenrator()
Dim MainWS As Worksheet
Dim InvoiceWS As Worksheet
Dim DataWS As Worksheet
'set workbook
Set MainWS = ThisWorkbook.Sheets("MOCK_DATA")
Set InvoiceWS = ThisWorkbook.Sheets("Invoice")
Set DataWS = ThisWorkbook.Sheets("Invoice Data")

'set lastrow
Dim MainLR As Long
Dim INvoiceLR As Long
MainLR = MainWS.Cells(MainWS.Rows.Count, 1).End(xlUp).Row
INvoiceLR = 14
'-----start a loops------
Dim a As Long
For a = 2 To 100
'create datalr
Dim DataLR As Long
DataLR = DataWS.Cells(DataWS.Rows.Count, 1).End(xlUp).Row

'fill up name column
Dim Name As String
Name = MainWS.Cells(a, "d").Value & MainWS.Cells(a, "b").Value & _
" " & MainWS.Cells(a, "c").Value
InvoiceWS.Range("b9").Value = Name
DataWS.Cells(DataLR + 1, "d").Value = Name

'fill up customerid
Dim CustomerID As String
CustomerID = MainWS.Cells(a, "a").Value
InvoiceWS.Range("b10").Value = CustomerID
DataWS.Cells(DataLR + 1, "c").Value = CustomerID

'fill Address
Dim ADDress As String
ADDress = MainWS.Cells(a, "e").Value
InvoiceWS.Range("b11").Value = ADDress
DataWS.Cells(DataLR + 1, "e").Value = ADDress

'fill EMail
Dim Email As String
Email = MainWS.Cells(a, "f").Value
InvoiceWS.Range("b12").Value = Email
DataWS.Cells(DataLR + 1, "f").Value = Email

'genrate and set invoiced
Dim Invoice As String
Dim InvoiceID As String
Dim LastinvoiceID
Invoice = "Y25SO00"
If DataWS.Cells(DataLR, 1).Value = "Invoice ID" Then
InvoiceID = Invoice & 1
Else
LastinvoiceID = DataWS.Cells(DataLR, 1).Value
InvoiceID = Invoice & CLng(Replace(LastinvoiceID, Invoice, "")) + 1
End If
InvoiceWS.Range("g9").Value = InvoiceID
DataWS.Cells(DataLR + 1, "a").Value = InvoiceID


'set invoicedata
Dim InvoiceDATE As Date
InvoiceDATE = MainWS.Cells(a, "g").Value
InvoiceWS.Range("g10").Value = InvoiceDATE
DataWS.Cells(DataLR + 1, "b").Value = InvoiceDATE

'set DEvicebrand
Dim deviceBRAND As String
deviceBRAND = MainWS.Cells(a, "h").Value
InvoiceWS.Cells(INvoiceLR + 2, "e").Value = deviceBRAND
DataWS.Cells(DataLR + 1, "g").Value = deviceBRAND

'sr.no
If deviceBRAND <> "" Then
InvoiceWS.Cells(INvoiceLR + 2, "b").Value = 1
End If


'set devoicemodule
Dim Model As String
Model = MainWS.Cells(a, "i").Value
InvoiceWS.Cells(INvoiceLR + 2, "c").Value = Model
DataWS.Cells(DataLR + 1, "h").Value = Model

'set Device release date
Dim releaseDATE As Integer
releaseDATE = MainWS.Cells(a, "j").Value
InvoiceWS.Cells(INvoiceLR + 2, "f").Value = releaseDATE
DataWS.Cells(DataLR + 1, "i").Value = releaseDATE

'set ipADDress
Dim ipADDress As String
ipADDress = MainWS.Cells(a, "k").Value
InvoiceWS.Cells(INvoiceLR + 3, "c").Value = ipADDress
InvoiceWS.Cells(INvoiceLR + 3, "c").WrapText = True
DataWS.Cells(DataLR + 1, "j").Value = ipADDress
'set amount
Dim Amount As Double
Amount = MainWS.Cells(a, "l").Value
InvoiceWS.Cells(INvoiceLR + 2, "g").Value = Amount
InvoiceWS.Cells(INvoiceLR + 2, "g").NumberFormat = "0.00"
DataWS.Cells(DataLR + 1, "k").Value = InvoiceWS.Cells(INvoiceLR + 2, "g").Value

'set discount
Dim DIscount As Integer
Dim disNAME As String
Select Case LCase(deviceBRAND)
Case "nokia", "honor", "vk", "hp", "lava", "lenovo"
DIscount = 20
Case "sony", "xolo", "htc", "pantech", "micromax", "tecno"
DIscount = 18
Case "realme", "oneplus", "motorola", "xioami"
DIscount = 15
Case "apple", "samsung", "oppo", "vivo"
DIscount = 10
Case Else
DIscount = 30
End Select
disNAME = "Discount @" & DIscount & "%"
InvoiceWS.Cells(INvoiceLR + 7, "e").Value = disNAME
InvoiceWS.Cells(INvoiceLR + 7, "e").Font.Bold = True

Dim discountAMT As Double
discountAMT = Amount * DIscount / 100
InvoiceWS.Cells(INvoiceLR + 7, "g").Value = discountAMT
InvoiceWS.Cells(INvoiceLR + 7, "g").NumberFormat = "0.00"
DataWS.Cells(DataLR + 1, "l").Value = InvoiceWS.Cells(INvoiceLR + 7, "g").Value _
& "(" & Mid(disNAME, 11, 2) & "%" & ")"


'set taxable amount'
Dim Taxable As String
Dim TaxableAMT As Double
Taxable = "Taxable Amount"
InvoiceWS.Cells(INvoiceLR + 8, "e").Value = Taxable
InvoiceWS.Cells(INvoiceLR + 8, "e").Font.Bold = True

TaxableAMT = Amount - discountAMT
InvoiceWS.Cells(INvoiceLR + 8, "g").Value = TaxableAMT
InvoiceWS.Cells(INvoiceLR + 8, "g").Font.Bold = True
InvoiceWS.Cells(INvoiceLR + 8, "g").NumberFormat = "0.00"
DataWS.Cells(DataLR + 1, "m").Value = InvoiceWS.Cells(INvoiceLR + 8, "g").Value

'set gst
Dim CGstAMT As Double
Dim SGstAMT As Double
InvoiceWS.Cells(INvoiceLR + 9, "e").Value = "CGST @9%"
InvoiceWS.Cells(INvoiceLR + 9, "e").Font.Bold = True

CGstAMT = TaxableAMT * 9 / 100
InvoiceWS.Cells(INvoiceLR + 9, "g").Value = CGstAMT
InvoiceWS.Cells(INvoiceLR + 9, "g").NumberFormat = "0.00"

InvoiceWS.Cells(INvoiceLR + 10, "e").Value = "SGST @9%"
InvoiceWS.Cells(INvoiceLR + 10, "e").Font.Bold = True
SGstAMT = TaxableAMT * 9 / 100
InvoiceWS.Cells(INvoiceLR + 10, "g").Value = SGstAMT
InvoiceWS.Cells(INvoiceLR + 10, "g").NumberFormat = "0.00"

DataWS.Cells(DataLR + 1, "n").Value = InvoiceWS.Cells(INvoiceLR + 9, "g").Value _
+ InvoiceWS.Cells(INvoiceLR + 10, "g").Value

'set total amount
Dim TotalAMount As Long
TotalAMount = TaxableAMT + CGstAMT + SGstAMT
InvoiceWS.Cells(INvoiceLR + 11, "e").Value = "Tatal Amount"

InvoiceWS.Cells(INvoiceLR + 11, "g").Value = TotalAMount

DataWS.Cells(DataLR + 1, "o").Value = TotalAMount

'set formating
Dim rng1  As Range
Set rng1 = InvoiceWS.Cells(INvoiceLR + 1, "B")
Dim rng2  As Range
 Set rng2 = InvoiceWS.Cells(INvoiceLR + 12, 7).MergeArea

With InvoiceWS.Range(rng1, rng2)
.Borders.LineStyle = xlContinuous
.Borders(xlEdgeLeft).Weight = xlThin
.Borders(xlEdgeLeft).Weight = xlMedium
.Borders(xlEdgeRight).Weight = xlMedium
.Borders(xlEdgeBottom).Weight = xlMedium
.Borders(xlInsideHorizontal).LineStyle = xlNone
End With
With InvoiceWS.Cells(INvoiceLR + 11, "e").MergeArea
.Font.Bold = True
.Borders.LineStyle = xlContinuous
.Borders.Weight = xlMedium
End With

With InvoiceWS.Cells(INvoiceLR + 11, "g").MergeArea
.Font.Bold = True
.Borders.LineStyle = xlContinuous
.Borders.Weight = xlMedium
End With
InvoiceWS.Cells(INvoiceLR + 12, 3).Value = " ::: This Bill is auto genrated :::"
With InvoiceWS.Cells(INvoiceLR + 12, "c").MergeArea
.Font.Bold = True
End With

'set pdf path and pdf area
Dim Path As String
Dim FIname  As String
FIname = Name & " " & InvoiceDATE
Path = "D:\invoice\" & FIname & ".pdf"
With InvoiceWS.PageSetup
.PrintArea = InvoiceWS.Range("a1", rng2).ADDress
.FitToPagesTall = 1
.FitToPagesWide = 1
.Orientation = xlPortrait
.Zoom = False
End With

Application.Wait (Now + TimeValue("0:00:01"))
InvoiceWS.ExportAsFixedFormat xlTypePDF, Path, xlQualityStandard, False, False




Next a
End Sub
